import * as tslib_1 from "tslib";
import { Pipe } from '@angular/core';
import { DateTime } from 'luxon';
import { UtilityService } from '../services/utilities.service';
var RangeDatePipe = /** @class */ (function () {
    function RangeDatePipe(utilityService) {
        var _this = this;
        this.utilityService = utilityService;
        this.days = { 'SU': 'Sun', 'MO': 'Mon', 'TU': 'Tue', 'WE': 'Wed', 'TH': 'Thu', 'FR': 'Fri', 'SA': 'Sat' };
        this.deprecatedVsNewTimeZones = this.utilityService.deprecatedVsNewTimeZones;
        this.transform = function (rangeDates, eventTimeZone, isRecurrent, args) {
            if (!eventTimeZone) {
                eventTimeZone = "Asia/Kolkata";
            }
            else {
                if (_this.deprecatedVsNewTimeZones[eventTimeZone] != undefined)
                    eventTimeZone = _this.deprecatedVsNewTimeZones[eventTimeZone];
            }
            if (rangeDates) {
                // for Recurring events
                if (isRecurrent && args['startTime'] && args['recurrenceRule']) {
                    var startTime = args['startTime'];
                    var freq = args['recurrenceRule'].split(';')[0].split('=')[1];
                    var freqLabel = 'Daily';
                    //custom date selected
                    if (args['recurrenceRule'].indexOf("RDATE") > -1) {
                        freqLabel = 'Multiple Dates';
                    }
                    else {
                        // predefined R Rule
                        if (freq.toLowerCase() == 'Weekly'.toLowerCase()) {
                            var byDays = args['recurrenceRule'].split(';')[2].split('=')[1].split(',');
                            if (byDays.length > 2) {
                                freqLabel = 'Multiple Dates';
                            }
                            else {
                                freqLabel = 'Every ';
                                for (var index = 0; index < byDays.length; index++) {
                                    freqLabel += _this.days[byDays[index]];
                                    if (index < (byDays.length - 1)) {
                                        freqLabel += ', ';
                                    }
                                }
                            }
                        }
                    }
                    return freqLabel + ' | ' + startTime;
                }
                else {
                    var local = DateTime.local().setZone(eventTimeZone);
                    // for other events or fallback
                    var date = rangeDates.map(function (d) { return DateTime.fromISO(d, { zone: eventTimeZone }).toFormat('dd'); });
                    var month = rangeDates.map(function (d) { return DateTime.fromISO(d, { zone: eventTimeZone }).toFormat('MMM'); });
                    var year = rangeDates.map(function (d) { return DateTime.fromISO(d, { zone: eventTimeZone }).toFormat('yy'); });
                    var time = DateTime.fromISO(rangeDates[0], { zone: eventTimeZone }).toFormat('hh:mm a');
                    var currYear = new Date().getUTCFullYear() % 100;
                    if (year[0] !== year[1]) {
                        return month[0] + ' ' + date[0] + '\'' + year[0] + ' - ' + month[1] + ' ' + date[1] + '\'' + year[1] + ' | ' + time;
                    }
                    else {
                        var yearSt = (year[0] - currYear) != 0 ? " '" + year[0] : '';
                        if ((date[0] === date[1]) && (month[0] === month[1])) {
                            return month[0] + ' ' + date[0] + yearSt + ' | ' + time;
                        }
                        else if ((month[0] !== month[1])) {
                            return month[0] + ' ' + date[0] + yearSt + ' - ' + month[1] + ' ' + date[1] + yearSt + ' | ' + time;
                        }
                        else {
                            return month[0] + ' ' + date[0] + ' - ' + date[1] + yearSt + ' | ' + time;
                        }
                    }
                }
            }
            else {
                return null;
            }
        };
    }
    RangeDatePipe = tslib_1.__decorate([
        Pipe({
            name: 'dateRange'
        }),
        tslib_1.__metadata("design:paramtypes", [UtilityService])
    ], RangeDatePipe);
    return RangeDatePipe;
}());
export { RangeDatePipe };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHMtZGF0ZS1yYW5nZS5waXBlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRvd25zY3JpcHQvY29tcG9uZW50cy8iLCJzb3VyY2VzIjpbInNyYy9hcHAvc2hhcmVkL3BpcGVzL3RzLWRhdGUtcmFuZ2UucGlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLElBQUksRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFDcEQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLE9BQU8sQ0FBQztBQUNqQyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFLL0Q7SUFNSSx1QkFBb0IsY0FBOEI7UUFBbEQsaUJBRUM7UUFGbUIsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBSmxELFNBQUksR0FBUSxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsSUFBSSxFQUFFLEtBQUssRUFBQyxJQUFJLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBRSxLQUFLLEVBQUMsSUFBSSxFQUFFLEtBQUssRUFBQyxJQUFJLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBRSxLQUFLLEVBQUMsQ0FBQztRQUVqRyw2QkFBd0IsR0FBUyxJQUFJLENBQUMsY0FBYyxDQUFDLHdCQUF3QixDQUFDO1FBTTlFLGNBQVMsR0FBRyxVQUFDLFVBQWUsRUFBRSxhQUFrQixFQUFFLFdBQWlCLEVBQUUsSUFBVTtZQUUzRSxJQUFHLENBQUMsYUFBYSxFQUFFO2dCQUNmLGFBQWEsR0FBQyxjQUFjLENBQUM7YUFDaEM7aUJBQU07Z0JBQ0gsSUFBRyxLQUFJLENBQUMsd0JBQXdCLENBQUMsYUFBYSxDQUFDLElBQUksU0FBUztvQkFDMUQsYUFBYSxHQUFHLEtBQUksQ0FBQyx3QkFBd0IsQ0FBQyxhQUFhLENBQUMsQ0FBQzthQUNsRTtZQUVELElBQUksVUFBVSxFQUFFO2dCQUNaLHVCQUF1QjtnQkFDdkIsSUFBRyxXQUFXLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLElBQUksQ0FBQyxn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RyxDQUFDO29CQUNsRCxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUU7d0JBQ3ZCLE9BQU8sS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxLQUFLLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDO3FCQUNySDt5QkFBTTt3QkFDTCxJQUFNLE1BQU0sR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQzt3QkFDN0QsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTs0QkFDcEQsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLEdBQUUsS0FBSyxHQUFHLElBQUksQ0FBQzt5QkFDeEQ7NkJBQU0sSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTs0QkFDbEMsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLEdBQUcsS0FBSyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLE1BQU0sR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDO3lCQUNyRzs2QkFBTTs0QkFDTCxPQUFPLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsTUFBTSxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUM7eUJBQzNFO3FCQUNGO2lCQUNGO2FBQ0o7aUJBQU07Z0JBQ0gsT0FBTyxJQUFJLENBQUM7YUFDZjtRQUNMLENBQUMsQ0FBQTtJQWpFRCxDQUFDO0lBUlEsYUFBYTtRQUh6QixJQUFJLENBQUM7WUFDRixJQUFJLEVBQUUsV0FBVztTQUNwQixDQUFDO2lEQU9zQyxjQUFjO09BTnpDLGFBQWEsQ0EwRXpCO0lBQUQsb0JBQUM7Q0FBQSxBQTFFRCxJQTBFQztTQTFFWSxhQUFhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGlwZSwgUGlwZVRyYW5zZm9ybSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRGF0ZVRpbWUgfSBmcm9tICdsdXhvbic7XG5pbXBvcnQgeyBVdGlsaXR5U2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3V0aWxpdGllcy5zZXJ2aWNlJztcblxuQFBpcGUoe1xuICAgIG5hbWU6ICdkYXRlUmFuZ2UnXG59KVxuZXhwb3J0IGNsYXNzIFJhbmdlRGF0ZVBpcGUgaW1wbGVtZW50cyBQaXBlVHJhbnNmb3JtIHtcblxuICAgIGRheXM6IGFueSA9IHsnU1UnOidTdW4nLCdNTyc6ICdNb24nLCdUVSc6ICdUdWUnLCdXRSc6ICdXZWQnLCdUSCc6ICdUaHUnLCdGUic6ICdGcmknLCdTQSc6ICdTYXQnfTtcblxuICAgIGRlcHJlY2F0ZWRWc05ld1RpbWVab25lcyA6IGFueSA9IHRoaXMudXRpbGl0eVNlcnZpY2UuZGVwcmVjYXRlZFZzTmV3VGltZVpvbmVzO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB1dGlsaXR5U2VydmljZTogVXRpbGl0eVNlcnZpY2Upe1xuXG4gICAgfVxuXG4gICAgdHJhbnNmb3JtID0gKHJhbmdlRGF0ZXM6IGFueSwgZXZlbnRUaW1lWm9uZTogYW55LCBpc1JlY3VycmVudD86IGFueSAsYXJncz86IGFueSk6IGFueSA9PiB7XG5cbiAgICAgICAgaWYoIWV2ZW50VGltZVpvbmUpIHtcbiAgICAgICAgICAgIGV2ZW50VGltZVpvbmU9XCJBc2lhL0tvbGthdGFcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmKHRoaXMuZGVwcmVjYXRlZFZzTmV3VGltZVpvbmVzW2V2ZW50VGltZVpvbmVdICE9IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgZXZlbnRUaW1lWm9uZSA9IHRoaXMuZGVwcmVjYXRlZFZzTmV3VGltZVpvbmVzW2V2ZW50VGltZVpvbmVdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJhbmdlRGF0ZXMpIHtcbiAgICAgICAgICAgIC8vIGZvciBSZWN1cnJpbmcgZXZlbnRzXG4gICAgICAgICAgICBpZihpc1JlY3VycmVudCAmJiBhcmdzWydzdGFydFRpbWUnXSAmJiBhcmdzWydyZWN1cnJlbmNlUnVsZSddKXtcblxuXG4gICAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IGFyZ3NbJ3N0YXJ0VGltZSddO1xuICAgICAgICAgICAgICBjb25zdCBmcmVxICAgPSBhcmdzWydyZWN1cnJlbmNlUnVsZSddLnNwbGl0KCc7JylbMF0uc3BsaXQoJz0nKVsxXTtcbiAgICAgICAgICAgICAgbGV0IGZyZXFMYWJlbCA9ICdEYWlseSc7XG4gICAgICAgICAgICAgIC8vY3VzdG9tIGRhdGUgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgaWYoYXJnc1sncmVjdXJyZW5jZVJ1bGUnXS5pbmRleE9mKFwiUkRBVEVcIikgPiAtMSl7XG4gICAgICAgICAgICAgICAgZnJlcUxhYmVsID0gJ011bHRpcGxlIERhdGVzJztcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBwcmVkZWZpbmVkIFIgUnVsZVxuICAgICAgICAgICAgICAgIGlmKGZyZXEudG9Mb3dlckNhc2UoKSA9PSAnV2Vla2x5Jy50b0xvd2VyQ2FzZSgpKXtcbiAgICAgICAgICAgICAgICAgIGxldCBieURheXMgPSBhcmdzWydyZWN1cnJlbmNlUnVsZSddLnNwbGl0KCc7JylbMl0uc3BsaXQoJz0nKVsxXS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgICAgaWYoYnlEYXlzLmxlbmd0aCA+IDIpe1xuICAgICAgICAgICAgICAgICAgICBmcmVxTGFiZWwgPSAnTXVsdGlwbGUgRGF0ZXMnO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZnJlcUxhYmVsID0gJ0V2ZXJ5ICc7XG4gICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaW5kZXggPSAwO2luZGV4IDwgYnlEYXlzLmxlbmd0aDsgaW5kZXgrKyl7XG4gICAgICAgICAgICAgICAgICAgICAgZnJlcUxhYmVsICs9IHRoaXMuZGF5c1tieURheXNbaW5kZXhdXTtcbiAgICAgICAgICAgICAgICAgICAgICBpZihpbmRleCA8IChieURheXMubGVuZ3RoIC0gMSkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJlcUxhYmVsICs9ICcsICc7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiAgZnJlcUxhYmVsICsgJyB8ICcgKyBzdGFydFRpbWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBsZXQgbG9jYWwgPSBEYXRlVGltZS5sb2NhbCgpLnNldFpvbmUoZXZlbnRUaW1lWm9uZSk7XG4gICAgICAgICAgICAgIC8vIGZvciBvdGhlciBldmVudHMgb3IgZmFsbGJhY2tcbiAgICAgICAgICAgICAgY29uc3QgZGF0ZSA9IHJhbmdlRGF0ZXMubWFwKGQgPT4gRGF0ZVRpbWUuZnJvbUlTTyhkICwgeyB6b25lOiBldmVudFRpbWVab25lIH0pLnRvRm9ybWF0KCdkZCcpKTtcbiAgICAgICAgICAgICAgY29uc3QgbW9udGggPSByYW5nZURhdGVzLm1hcChkID0+IERhdGVUaW1lLmZyb21JU08oZCwgeyB6b25lOiBldmVudFRpbWVab25lIH0pLnRvRm9ybWF0KCdNTU0nKSk7XG4gICAgICAgICAgICAgIGNvbnN0IHllYXIgPSByYW5nZURhdGVzLm1hcChkID0+IERhdGVUaW1lLmZyb21JU08oZCwgeyB6b25lOiBldmVudFRpbWVab25lIH0pLnRvRm9ybWF0KCd5eScpKTtcbiAgICAgICAgICAgICAgY29uc3QgdGltZSA9IERhdGVUaW1lLmZyb21JU08ocmFuZ2VEYXRlc1swXSwgeyB6b25lOiBldmVudFRpbWVab25lIH0pLnRvRm9ybWF0KCdoaDptbSBhJyk7XG5cbiAgICAgICAgICAgICAgY29uc3QgY3VyclllYXIgPSBuZXcgRGF0ZSgpLmdldFVUQ0Z1bGxZZWFyKCklIDEwMDtcbiAgICAgICAgICAgICAgaWYgKHllYXJbMF0gIT09IHllYXJbMV0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9udGhbMF0gKyAnICcgKyBkYXRlWzBdICsgJ1xcJycgKyB5ZWFyWzBdICsgJyAtICcgKyBtb250aFsxXSArICcgJyArIGRhdGVbMV0gKyAnXFwnJyArIHllYXJbMV0gKyAnIHwgJyArIHRpbWU7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeWVhclN0ID0gKHllYXJbMF0gLSBjdXJyWWVhcikgIT0gMCA/IFwiICdcIit5ZWFyWzBdIDogJyc7XG4gICAgICAgICAgICAgICAgaWYgKChkYXRlWzBdID09PSBkYXRlWzFdKSAmJiAobW9udGhbMF0gPT09IG1vbnRoWzFdKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vbnRoWzBdICsgJyAnICsgZGF0ZVswXSArIHllYXJTdCArJyB8ICcgKyB0aW1lO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKG1vbnRoWzBdICE9PSBtb250aFsxXSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBtb250aFswXSArICcgJyArIGRhdGVbMF0gKyB5ZWFyU3QgKyAnIC0gJyArIG1vbnRoWzFdICsgJyAnICsgZGF0ZVsxXSArIHllYXJTdCArICcgfCAnICsgdGltZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vbnRoWzBdICsgJyAnICsgZGF0ZVswXSArICcgLSAnICsgZGF0ZVsxXSArIHllYXJTdCArICcgfCAnICsgdGltZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuIl19